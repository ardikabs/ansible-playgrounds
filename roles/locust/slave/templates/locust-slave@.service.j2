[Unit]
Description=Locust slave %i
Documentation=https://locust.io
Requires=network-online.target
After=network-online.target

[Service]
Type=simple
Restart=always
ExecStart=/usr/local/bin/locust -f /opt/locustfile.py --slave --master-host={{ hostvars[groups['master'][0]].ansible_default_ipv4.address }} --master-port={{ master_port }}
PermissionsStartOnly=true
LimitNPROC=infinity
LimitNOFILE=infinity

[Install]
WantedBy=multi-user.target
